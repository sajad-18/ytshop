{% extends 'base.html' %}


{% block link %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'home/css/store.css' %}">
{% endblock %}

{% block content %}
    <section class="products">
        <div class="header">
            <div class="_head">
                <div class="head-filter">
                    <div onclick="openForm()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17.998" viewBox="0 0 18 17.998">
                          <path id="sort" d="M181.007,106.04a1.124,1.124,0,0,0-1.591,0l-1.455,1.455V94.46a1.125,1.125,0,0,0-2.25,0v13.034l-1.455-1.455h0a1.125,1.125,0,0,0-1.591,1.591l3.375,3.375h0a1.129,1.129,0,0,0,1.592,0l3.374-3.375a1.124,1.124,0,0,0,0-1.591ZM164.462,96.71h7.875a1.125,1.125,0,1,0,0-2.25h-7.875a1.125,1.125,0,1,0,0,2.25Zm5.625,2.25h-5.625a1.125,1.125,0,0,0,0,2.25h5.625a1.125,1.125,0,0,0,0-2.25Zm-2.25,4.5h-3.375a1.125,1.125,0,0,0,0,2.25h3.375a1.125,1.125,0,0,0,0-2.25Zm-2.25,4.5h-1.125a1.125,1.125,0,1,0,0,2.25h1.125a1.125,1.125,0,1,0,0-2.25Z" transform="translate(-163.337 -93.335)" fill="#cf1322"/>
                        </svg>
                    </div>
                    <div onclick="openForm()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18.067" height="18" viewBox="0 0 18.067 18">
                          <path id="filter" d="M192.163,113.749h-9.2a2.71,2.71,0,0,0-5.086,0H175.9a.9.9,0,1,0,0,1.807h1.969a2.71,2.71,0,0,0,5.086,0h9.2a.9.9,0,1,0,0-1.807Zm-11.743,1.807a.9.9,0,1,1,.639-.265A.9.9,0,0,1,180.419,115.555Zm11.743,4.517h-3.776a2.71,2.71,0,0,0-5.086,0h-7.4a.9.9,0,1,0,0,1.807h7.389a2.71,2.71,0,0,0,5.086,0h3.785a.9.9,0,1,0,0-1.807Zm-6.323,1.807a.9.9,0,1,1,.639-.265A.9.9,0,0,1,185.839,121.879ZM175.9,109.232H186a2.71,2.71,0,0,0,5.086,0h1.075a.9.9,0,1,0,0-1.807H191.1a2.71,2.71,0,0,0-5.086,0H175.9a.9.9,0,1,0,0,1.807Zm12.647-1.807a.9.9,0,1,1-.639.265A.9.9,0,0,1,188.549,107.425Z" transform="translate(-174.999 -105.652)" fill="#cf1322"/>
                        </svg>
                    </div>
                </div>
                <div class="head-store">
                    <h1>فروشگاه</h1>
                </div>
            </div>
        </div>
        <div class="filter-popup" id="filter-popup">
            <form method="GET" action="">
                    <div class="container">
                        <div class="ckeck">
                            <div class="sort">
                                <div class="sort-head">
                                    <p>مرتب سازی بر اساس...</p>
                                    <i class="arrow down"></i>
                                </div>
                                <div class="sort-content">
                                    <div class="form-check">
                                        {{ filter_form.price_asc }}
                                        <label class="form-check-label" for="{{ sort_form.price_asc.id_for_label }}">قیمت کم به زیاد</label>
                                    </div>
                                    <div class="form-check">
                                        {{ filter_form.price_desc }}
                                        <label class="form-check-label" for="{{ sort_form.price_desc.id_for_label }}">قیمت زیاد به کم</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <hr>
                    <div class="container">
                        <div class="region">
                            <div class="region-head">
                                <p>ریجن اکانت...</p>
                                <i class="arrow down"></i>
                            </div>
                            <div class="region-content">
                                {% for checkbox in filter_form.region %}
                                    <div class="form-check">
                                        {{ checkbox }}
                                    </div>
                                {% endfor %}
                            </div>
                        </div>

                    </div>

                    <button type="submit" class="submit-filter">اعمال تغییرات</button>
                    <button type="button" class="submit-filter cancel" onclick="closeForm()">بستن</button>
                </form>
        </div>
        <div class="container">
            <div class="filter">
                <h3>فیلتر جستجو</h3>
                <hr>
                <form method="GET" action="">
                    <div class="container">
                        <div class="ckeck">
                            <div class="dropdown">
                                <div onclick="myFunction()" class="dropbtn">
                                    <p>مرتب سازی بر اساس...</p>
                                    <i class="arrow down"></i>
                                </div>
                                <div id="myDropdown" class="dropdown-content">
                                    <div class="form-check">
                                        {{ filter_form.price_asc }}
                                        <label class="form-check-label" for="{{ sort_form.price_asc.id_for_label }}">قیمت کم به زیاد</label>
                                    </div>
                                    <div class="form-check">
                                        {{ filter_form.price_desc }}
                                        <label class="form-check-label" for="{{ sort_form.price_desc.id_for_label }}">قیمت زیاد به کم</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <hr>
                    <div class="container">
                        <div class="dropdown-r">
                            <div onclick="rFunction()" class="dropbtn-r">
                                <p>ریجن اکانت...</p>
                                <i class="arrow down"></i>
                            </div>
                            <div id="myDropdown-r" class="dropdown-content-r">
                                {% for checkbox in filter_form.region %}
                                    <div class="form-check">
                                        {{ checkbox }}
                                    </div>
                                {% endfor %}
                            </div>
                        </div>

                    </div>

                    <button type="submit" class="submit-filter">اعمال تغییرات</button>
                </form>
            </div>
            <div class="carts">
                {% for ad in page_obj %}
                        <a href="{{ ad.get_absolute_url }}" class="_cart">
                            <div class="__image">
                                <img src="{{ ad.image_lobby.url }}" alt="">
                            </div>
                            <div class="__detail">
                                <p>{{ ad.name }} {{ ad.id }}</p>
                                <p>تعداد فول گردونه: 5 عدد</p>
                            </div>
                            <div class="__price">
                                <div>
                                    <p>{{ ad.price }}</p>
                                    <p>تومان</p>
                                </div>
                                <div>
                                    <form action="{% url 'orders:cart_add' ad.id %}" method="post">
                                        {% csrf_token %}
                                        {{ add_cart }}
                                        <input type="submit" class="add_cart" value="خرید">
                                    </form>
                                </div>
                            </div>
                            <div class="__dicount">
                                <svg xmlns="http://www.w3.org/2000/svg" width="39" height="26" viewBox="0 0 39 26">
                                    <path id="Path_43" data-name="Path 43" d="M2,0H39V26H2a2,2,0,0,1-2-2V2A2,2,0,0,1,2,0Z" fill="#0a0a0a"/>
                                    <path id="Path_16" data-name="Path 16" d="M167.644,162.86a.335.335,0,0,1,.406.039L172.3,166.6l2.97-4.852a.356.356,0,0,1,.632,0l2.972,4.852,4.25-3.705a.328.328,0,0,1,.4-.039.48.48,0,0,1,.208.417v7.493a.427.427,0,0,1-.378.469H167.815a.427.427,0,0,1-.379-.469v-7.493a.48.48,0,0,1,.208-.417Z" transform="translate(-155 -156)" fill="#ffba01"/>
                                    <path id="Path_17" data-name="Path 17" d="M167.823,370.72H183.36a.42.42,0,0,1,.378.462v.55a.413.413,0,0,1-.378.455H167.823a.413.413,0,0,1-.379-.455v-.55A.42.42,0,0,1,167.823,370.72Z" transform="translate(-155 -353)" fill="#ffba01"/>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="31" viewBox="0 0 50 31">
                                    <g id="off" transform="translate(-181 -1016)">
                                      <path id="Rectangle_15" data-name="Rectangle 15" d="M0,0H48a2,2,0,0,1,2,2V24a2,2,0,0,1-2,2H0a0,0,0,0,1,0,0V0A0,0,0,0,1,0,0Z" transform="translate(181 1016)" fill="#cf1322"/>
                                      <text id="_20" data-name="%20" transform="translate(225 1034)" fill="#fff" font-size="16" font-family="SegoeUI-Bold, Segoe UI" font-weight="700"><tspan x="-32.281" y="0">%20</tspan></text>
                                      <text id="_" transform="translate(193 1028)" fill="#fff" font-size="16" font-family="SegoeUI, Segoe UI"><tspan x="-6.641" y="0">_</tspan></text>
                                    </g>
                                </svg>
                            </div>
                        </a>
                    {% endfor %}
                <div class="pagination">
            {% if page_obj.has_previous %}
                <a class="prev-page" href="?page={{ page_obj.previous_page_number }}">&laquo;</a>
            {% endif %}
            {% for num in page_obj.paginator.page_range %}
                {% if num == page_obj.number %}
                    <a class="page-link active">{{ num }}</a>
                {% else %}
                    <a href="?page={{ num }}">{{ num }}</a>
                {% endif %}
            {% endfor %}
            {% if page_obj.has_next %}
                <a class="next-page" href="?page={{ page_obj.next_page_number }}">&raquo;</a>
            {% endif %}
        </div>
            </div>
        </div>

    </section>
{% endblock %}

{% block script %}
    <script>

        // checkbox
        document.addEventListener('DOMContentLoaded', function() {
        var checkboxes = document.querySelectorAll('input[name*="price"]');
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                checkboxes.forEach(function(cb) {
                    if (cb !== checkbox) {
                        cb.checked = false;
                        }
                    });
                });
            });
        });

        // order dropdown
        function myFunction() {
          document.getElementById("myDropdown").classList.toggle("show");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
          if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        }

        // region dropdown
        function rFunction() {
          document.getElementById("myDropdown-r").classList.toggle("showr");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
          if (!event.target.matches('.dropbtn-r')) {
            var dropdowns = document.getElementsByClassName("dropdown-content-r");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('showr')) {
                openDropdown.classList.remove('showr');
              }
            }
          }
        }


        const checkbox = document.getElementById('checkbox');
        const button =document.getElementById('button');
        function toggleDisabled() {
            button.disabled = !checkbox.checked;
        }

        checkbox.addEventListener('change', toggleDisabled);

        toggleDisabled();


        //filter-popup

        function openForm() {
          document.getElementById("filter-popup").style.display = "block";
        }

        function closeForm() {
          document.getElementById("filter-popup").style.display = "none";
        }
    </script>
{% endblock %}


